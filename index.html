<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mina's Saving</title>

<style>
body{
    font-family:'Segoe UI',sans-serif;
    margin:0;
    background:linear-gradient(135deg,#ffd6e7,#d6f0ff,#fff0c9);
    min-height:100vh;
    overflow-x:hidden;
}

/* Background animation */
body::before{
    content:"";
    position:fixed;
    width:200%;
    height:200%;
    background:radial-gradient(circle,#ffffff55 1px,transparent 1px);
    background-size:40px 40px;
    animation:moveBg 20s linear infinite;
    z-index:-1;
}
@keyframes moveBg{
    from{transform:translate(0,0);}
    to{transform:translate(-200px,-200px);}
}

.page{
    display:none;
    padding:20px;
    text-align:center;
    animation:fade 0.7s;
}
.active{display:block;}

@keyframes fade{
    from{opacity:0; transform:translateY(20px);}
    to{opacity:1; transform:translateY(0);}
}

h1{
    color:#ff6fa5;
    font-size:2.5em;
    margin-top:30vh;
}

button{
    padding:12px 20px;
    border:none;
    border-radius:15px;
    background:#ff9ecb;
    color:white;
    font-size:16px;
    margin:5px;
    cursor:pointer;
    transition:0.3s;
}
button:hover{
    transform:scale(1.1);
    background:#ff7ab8;
}

.card{
    background:white;
    border-radius:20px;
    padding:20px;
    box-shadow:0 10px 20px rgba(0,0,0,0.1);
    margin:10px auto;
    max-width:420px;
}

input{
    padding:10px;
    border-radius:10px;
    border:1px solid #ccc;
    width:80%;
    margin:5px;
}

table{
    width:100%;
    border-collapse:collapse;
}
th,td{
    padding:8px;
    border-bottom:1px solid #eee;
}

.total{
    font-weight:bold;
    color:#ff6fa5;
    font-size:18px;
}

/* Floating emoji */
.emoji{
    position:fixed;
    font-size:24px;
    animation:float 6s linear infinite;
}
@keyframes float{
    from{transform:translateY(100vh);}
    to{transform:translateY(-10vh);}
}

/* Stars */
.star{
    font-size:30px;
    cursor:pointer;
    transition:0.2s;
}
.star:hover{
    transform:scale(1.3);
}

@media(max-width:600px){
    h1{font-size:2em;margin-top:25vh;}
}
</style>
</head>

<body>

<!-- SOUND -->
<audio id="coinSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_c1c4b6a8c1.mp3"></audio>
<audio id="ohnoSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8c2b6c6d9b.mp3"></audio>

<!-- Floating emojis -->
<div class="emoji" style="left:10%">üí∞</div>
<div class="emoji" style="left:40%">üå∏</div>
<div class="emoji" style="left:70%">‚ú®</div>

<!-- PAGE 1 -->
<div class="page active" id="page1">
    <h1>Mina's Saving</h1>
    <p>Manage your saving with Mina üíñ</p>
    <button onclick="nextPage(2)">Start</button>
</div>

<!-- PAGE 2 -->
<div class="page" id="page2">
    <div class="card">
        <h2>Target Tabungan üéØ</h2>
        <input type="number" id="targetInput" placeholder="Masukkan target">
        <br>
        <button onclick="setTarget()">Simpan Target</button>
        <button onclick="nextPage(1)">Kembali</button>
    </div>
</div>

<!-- PAGE 3 -->
<div class="page" id="page3">
    <div class="card">
        <h2>Catatan Tabungan üí∞</h2>

        <input type="number" id="amountInput" placeholder="Jumlah uang">
        <br>
        <button onclick="addMoney()">‚ûï Nabung</button>
        <button onclick="takeMoney()">‚ûñ Ambil</button>
        <button onclick="nextPage(2)">Kembali</button>

        <table id="table">
            <thead>
                <tr>
                    <th>Hari</th>
                    <th>Tanggal</th>
                    <th>Jumlah</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <p class="total">Total: Rp <span id="total">0</span></p>

        <hr>

        <h3>Rate Mina's Saving ‚≠ê</h3>
        <div>
            <span class="star" onclick="rate(1)">‚≠ê</span>
            <span class="star" onclick="rate(2)">‚≠ê</span>
            <span class="star" onclick="rate(3)">‚≠ê</span>
            <span class="star" onclick="rate(4)">‚≠ê</span>
            <span class="star" onclick="rate(5)">‚≠ê</span>
        </div>

        <p>Rating rata-rata: <b><span id="avgRating">0</span> ‚≠ê</b></p>
        <p>Total penilai: <b><span id="totalUser">0</span></b></p>

    </div>
</div>

<script>
let total = 0;
let data = [];
let ratings = JSON.parse(localStorage.getItem("minaRatings")) || [];

const coin = document.getElementById("coinSound");
const ohno = document.getElementById("ohnoSound");

/* Format Rupiah */
function formatRupiah(num){
    return num.toLocaleString("id-ID");
}

/* Navigation */
function nextPage(page){
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    document.getElementById("page"+page).classList.add("active");
}

/* Save */
function saveData(){
    localStorage.setItem("minaTotal", total);
    localStorage.setItem("minaData", JSON.stringify(data));
}

/* Load */
function loadData(){
    total = parseInt(localStorage.getItem("minaTotal")) || 0;
    data = JSON.parse(localStorage.getItem("minaData")) || [];
    updateTable();
}

/* Target */
function setTarget(){
    alert("Target tersimpan üíñ");
    nextPage(3);
}

/* Add Money */
function addMoney(){
    let amount = parseInt(document.getElementById("amountInput").value);
    if(!amount) return;

    coin.play();

    total += amount;
    addRow(amount);
    saveData();
}

/* Take Money */
function takeMoney(){
    let amount = parseInt(document.getElementById("amountInput").value);
    if(!amount) return;

    ohno.play();

    total -= amount;
    addRow(-amount);
    saveData();
}

/* Add Row */
function addRow(amount){
    let now = new Date();
    let hari = now.toLocaleDateString("id-ID",{weekday:"long"});
    let tgl = now.toLocaleDateString("id-ID");

    data.push({hari,tgl,amount});
    updateTable();
}

/* Update Table */
function updateTable(){
    let tbody = document.querySelector("#table tbody");
    tbody.innerHTML = "";

    data.forEach(d=>{
        let row = `
        <tr>
            <td>${d.hari}</td>
            <td>${d.tgl}</td>
            <td>${formatRupiah(d.amount)}</td>
        </tr>`;
        tbody.innerHTML += row;
    });

    document.getElementById("total").innerText = formatRupiah(total);
}

/* Rating */
function rate(star){
    ratings.push(star);
    localStorage.setItem("minaRatings", JSON.stringify(ratings));
    updateRating();
    alert("Makasih sudah kasih rating üíñ");
}

function updateRating(){
    if(ratings.length === 0) return;

    let totalRate = ratings.reduce((a,b)=>a+b,0);
    let avg = (totalRate / ratings.length).toFixed(1);

    document.getElementById("avgRating").innerText = avg;
    document.getElementById("totalUser").innerText = ratings.length;
}

/* Load start */
loadData();
updateRating();
</script>

</body>
</html>
