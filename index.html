<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mina's Saving</title>

<style>
body{
  margin:0;
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg,#ffd6e7,#d6f0ff,#fff0d6);
  min-height:100vh;
}

.page{
  display:none;
  min-height:100vh;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  padding:20px;
  text-align:center;
  animation: fade 0.6s ease;
}

.active{ display:flex }

@keyframes fade{
  from{opacity:0; transform:translateY(20px)}
  to{opacity:1; transform:translateY(0)}
}

h1{ color:#ff6fa5 }

.card{
  background:white;
  padding:20px;
  border-radius:20px;
  box-shadow:0 10px 25px rgba(0,0,0,0.1);
  margin:10px;
  width:100%;
  max-width:400px;
}

button{
  padding:10px 18px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin:5px;
  font-size:14px;
}

.primary{ background:#ff8fab; color:white }
.secondary{ background:#90dbf4 }
.danger{ background:#ff6b6b; color:white }
.back{ background:#ccc }

input{
  padding:10px;
  border-radius:10px;
  border:1px solid #ddd;
  margin:5px;
  width:100%;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:10px;
  width:100%;
  max-width:500px;
}

.iconCard{
  background:white;
  padding:15px;
  border-radius:15px;
  cursor:pointer;
  box-shadow:0 5px 15px rgba(0,0,0,0.1);
  transition:0.3s;
}

.iconCard:hover{
  transform:scale(1.05);
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

th,td{
  padding:6px;
  border-bottom:1px solid #ddd;
  font-size:12px;
}

.star{ font-size:28px; cursor:pointer }

</style>
</head>

<body>

<audio id="coinSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_4010d5c1b4.mp3?filename=coin-collect-19324.mp3"></audio>
<audio id="failSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_9c6c13c370.mp3?filename=error-126627.mp3"></audio>

<!-- PAGE 1 -->
<div class="page active" id="page1">
  <h1>Mina's Saving üí∞</h1>
  <p>Manage your saving with Mina ‚ú®</p>
  <button class="primary" onclick="goPage(2)">Start</button>
</div>

<!-- PAGE 2 : LIST TABUNGAN -->
<div class="page" id="page2">
  <h2>Pilih Tabungan</h2>

  <div class="card">
    <input id="judulTabungan" placeholder="Judul tabungan (contoh: Tabungan HP)">
    <input id="targetTabungan" placeholder="Target uang">
    <button class="primary" onclick="tambahTabungan()">Tambah</button>
  </div>

  <div class="grid" id="listTabungan"></div>

  <button class="back" onclick="goPage(1)">Kembali</button>
</div>

<!-- PAGE 3 : DETAIL -->
<div class="page" id="page3">
  <h2 id="judulDetail"></h2>

  <div class="card">
    <input type="date" id="tanggal">
    <input id="jumlah" placeholder="Jumlah uang">
    <br>
    <button class="secondary" onclick="tambahUang()">+ Nabung</button>
    <button class="danger" onclick="kurangUang()">‚àí Ambil</button>
  </div>

  <div class="card">
    <h3>Total: Rp <span id="total">0</span></h3>
    <table>
      <thead>
        <tr>
          <th>Tanggal</th>
          <th>Masuk</th>
          <th>Keluar</th>
        </tr>
      </thead>
      <tbody id="tabel"></tbody>
    </table>
  </div>

  <button class="back" onclick="goPage(2)">Kembali</button>
</div>

<!-- RATING -->
<div class="card" style="position:fixed;bottom:10px;right:10px">
  <div id="stars">
    <span class="star" onclick="rate(1)">‚≠ê</span>
    <span class="star" onclick="rate(2)">‚≠ê</span>
    <span class="star" onclick="rate(3)">‚≠ê</span>
    <span class="star" onclick="rate(4)">‚≠ê</span>
    <span class="star" onclick="rate(5)">‚≠ê</span>
  </div>
  <small>Rating: <span id="avg">0</span>/5</small>
</div>

<script>
let data = JSON.parse(localStorage.getItem("minaSaving")) || [];
let current = null;

function goPage(p){
  document.querySelectorAll('.page').forEach(el=>el.classList.remove('active'));
  document.getElementById('page'+p).classList.add('active');
  if(p===2) renderTabungan();
}

function formatRupiah(angka){
  return angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}

function tambahTabungan(){
  let judul = document.getElementById('judulTabungan').value;
  let target = parseInt(document.getElementById('targetTabungan').value);
  if(!judul || !target) return;

  data.push({judul,target,total:0,riwayat:[]});
  simpan();
  renderTabungan();
}

function renderTabungan(){
  let list = document.getElementById('listTabungan');
  list.innerHTML='';

  data.forEach((tab,i)=>{
    let div=document.createElement('div');
    div.className='iconCard';
    div.innerHTML=`üí∞<br>${tab.judul}`;
    div.onclick=()=>bukaDetail(i);
    list.appendChild(div);
  });
}

function bukaDetail(i){
  current=i;
  document.getElementById('judulDetail').innerText=data[i].judul;
  renderDetail();
  goPage(3);
}

function renderDetail(){
  let tab=data[current];
  document.getElementById('total').innerText=formatRupiah(tab.total);

  let tbody=document.getElementById('tabel');
  tbody.innerHTML='';

  tab.riwayat.forEach(r=>{
    tbody.innerHTML+=`
      <tr>
        <td>${r.tanggal}</td>
        <td>${r.masuk? 'Rp '+formatRupiah(r.masuk):'-'}</td>
        <td>${r.keluar? 'Rp '+formatRupiah(r.keluar):'-'}</td>
      </tr>`;
  });
}

function tambahUang(){
  let tgl=document.getElementById('tanggal').value;
  let jml=parseInt(document.getElementById('jumlah').value);
  if(!tgl||!jml) return;

  let tab=data[current];
  tab.total+=jml;
  tab.riwayat.push({tanggal:tgl,masuk:jml});
  document.getElementById('coinSound').play();
  simpan();
  renderDetail();
}

function kurangUang(){
  let tgl=document.getElementById('tanggal').value;
  let jml=parseInt(document.getElementById('jumlah').value);
  if(!tgl||!jml) return;

  let tab=data[current];
  tab.total-=jml;
  tab.riwayat.push({tanggal:tgl,keluar:jml});
  document.getElementById('failSound').play();
  simpan();
  renderDetail();
}

function simpan(){
  localStorage.setItem("minaSaving",JSON.stringify(data));
}

// RATING
let ratings=JSON.parse(localStorage.getItem("rating"))||[];
function rate(n){
  ratings.push(n);
  localStorage.setItem("rating",JSON.stringify(ratings));
  tampilRating();
}

function tampilRating(){
  if(ratings.length===0) return;
  let avg=ratings.reduce((a,b)=>a+b,0)/ratings.length;
  document.getElementById('avg').innerText=avg.toFixed(1);
}

tampilRating();
</script>

</body>
</html>
